# åˆ©ç¾¤åå®¹é“æ¸¸æˆ - å‰ç«¯ç™»å½•é€»è¾‘æ€»ç»“

## æ¦‚è¿°
æœ¬æ–‡æ¡£æ€»ç»“äº†åˆ©ç¾¤åå®¹é“æ¸¸æˆä¸­å‰ç«¯ç™»å½•åŠŸèƒ½çš„å®Œæ•´å®ç°é€»è¾‘ï¼ŒåŒ…æ‹¬å·¥å·å§“åæ ¡éªŒã€ç”¨æˆ·çŠ¶æ€ç®¡ç†ã€UIäº¤äº’ç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚

## 1. æ•°æ®ç»“æ„

### 1.1 ç”¨æˆ·æ•°æ®æº
- **æ–‡ä»¶ä½ç½®**: `people.json`
- **æ•°æ®æ ¼å¼**: JSONæ•°ç»„ï¼ŒåŒ…å«å·¥å·å’Œå§“åä¿¡æ¯
```json
[
  {"å·¥å·": "62344", "å§“å": "èƒ¡æ˜è±ª"},
  {"å·¥å·": "0", "å§“å": "0"},
  {"å·¥å·": "1", "å§“å": "1"},
  // ... æ›´å¤šç”¨æˆ·æ•°æ®
]
```

### 1.2 ç”¨æˆ·çŠ¶æ€ç®¡ç†
```javascript
// æ¸¸æˆå®ä¾‹ä¸­çš„ç”¨æˆ·ç›¸å…³å±æ€§
this.isLoggedIn = false;           // ç™»å½•çŠ¶æ€
this.currentUser = null;           // å½“å‰ç”¨æˆ·ä¿¡æ¯
this.peopleData = null;            // äººå‘˜æ•°æ®ç¼“å­˜
```

## 2. ç™»å½•æµç¨‹

### 2.1 ç™»å½•ç•Œé¢
- **è§¦å‘æ–¹å¼**: ç‚¹å‡»"ğŸ” ç™»å½•"æŒ‰é’®
- **ç•Œé¢å…ƒç´ **: 
  - å·¥å·è¾“å…¥æ¡† (`employeeId`)
  - å§“åè¾“å…¥æ¡† (`employeeName`)
  - ç™»å½•/å–æ¶ˆæŒ‰é’®
  - é”™è¯¯æç¤ºåŒºåŸŸ (`loginError`)

### 2.2 ç™»å½•éªŒè¯æµç¨‹

#### 2.2.1 æ•°æ®åŠ è½½
```javascript
async loadPeopleData() {
    try {
        const response = await fetch('people.json');
        this.peopleData = await response.json();
        this.init();
    } catch (error) {
        console.error('åŠ è½½äººå‘˜æ•°æ®å¤±è´¥:', error);
        // ä½¿ç”¨é»˜è®¤æ•°æ®ä½œä¸ºåå¤‡
        this.peopleData = [
            {"å·¥å·": "1", "å§“å": "å¼ ä¸‰"},
            {"å·¥å·": "2", "å§“å": "æå››"},
            {"å·¥å·": "3", "å§“å": "ç‹äº”"}
        ];
        this.init();
    }
}
```

#### 2.2.2 å·¥å·å§“åæ ¡éªŒ
```javascript
validateLogin(employeeId, employeeName) {
    if (!this.peopleData) return false;
    
    return this.peopleData.some(person => 
        person.å·¥å· === employeeId && person.å§“å === employeeName
    );
}
```

**æ ¡éªŒé€»è¾‘**:
1. æ£€æŸ¥äººå‘˜æ•°æ®æ˜¯å¦å·²åŠ è½½
2. ä½¿ç”¨ `Array.some()` æ–¹æ³•éå†æ‰€æœ‰äººå‘˜æ•°æ®
3. ç²¾ç¡®åŒ¹é…å·¥å·å’Œå§“åï¼ˆå­—ç¬¦ä¸²å®Œå…¨åŒ¹é…ï¼‰
4. è¿”å›å¸ƒå°”å€¼è¡¨ç¤ºéªŒè¯ç»“æœ

#### 2.2.3 ç™»å½•å¤„ç†
```javascript
login(employeeId, employeeName) {
    if (this.validateLogin(employeeId, employeeName)) {
        this.isLoggedIn = true;
        this.currentUser = { å·¥å·: employeeId, å§“å: employeeName };
        this.updateUserInfo();
        this.updateRemainingAttemptsUI();
        this.closeLoginModal();
        return true;
    }
    return false;
}
```

**ç™»å½•æˆåŠŸåçš„æ“ä½œ**:
1. è®¾ç½®ç™»å½•çŠ¶æ€ä¸º `true`
2. ä¿å­˜å½“å‰ç”¨æˆ·ä¿¡æ¯
3. æ›´æ–°ç”¨æˆ·ä¿¡æ¯æ˜¾ç¤º
4. æ›´æ–°å‰©ä½™æ¬¡æ•°æ˜¾ç¤º
5. å…³é—­ç™»å½•å¼¹çª—

### 2.3 è¡¨å•æäº¤å¤„ç†

#### 2.3.1 è¡¨å•éªŒè¯
```javascript
function handleLogin(event) {
    event.preventDefault();
    
    const employeeId = document.getElementById('employeeId').value.trim();
    const employeeName = document.getElementById('employeeName').value.trim();
    const errorElement = document.getElementById('loginError');
    
    // åŸºç¡€éªŒè¯
    if (!employeeId || !employeeName) {
        errorElement.textContent = 'è¯·è¾“å…¥å·¥å·å’Œå§“å';
        errorElement.style.display = 'block';
        return;
    }
    
    // è°ƒç”¨ç™»å½•æ–¹æ³•
    if (game.login(employeeId, employeeName)) {
        // ç™»å½•æˆåŠŸ
        errorElement.style.display = 'none';
        // åŒæ­¥å‰©ä½™æ¬¡æ•°
        syncRemainingAttempts(employeeId);
    } else {
        // ç™»å½•å¤±è´¥
        errorElement.textContent = 'å·¥å·æˆ–å§“åè¾“å…¥é”™è¯¯';
        errorElement.style.display = 'block';
    }
}
```

#### 2.3.2 é”™è¯¯å¤„ç†
- **ç©ºå€¼æ£€æŸ¥**: ç¡®ä¿å·¥å·å’Œå§“åéƒ½ä¸ä¸ºç©º
- **æ ¡éªŒå¤±è´¥**: æ˜¾ç¤º"å·¥å·æˆ–å§“åè¾“å…¥é”™è¯¯"
- **ç½‘ç»œé”™è¯¯**: ä½¿ç”¨é»˜è®¤æ•°æ®ä½œä¸ºåå¤‡

## 3. ç”¨æˆ·çŠ¶æ€ç®¡ç†

### 3.1 ç”¨æˆ·ä¿¡æ¯æ˜¾ç¤º
```javascript
updateUserInfo() {
    const userInfoElement = document.getElementById('userInfo');
    if (this.isLoggedIn && this.currentUser) {
        userInfoElement.textContent = `${this.currentUser.å§“å}(${this.currentUser.å·¥å·})`;
        userInfoElement.style.color = '#4CAF50';
    } else {
        userInfoElement.textContent = 'æœªç™»å½•';
        userInfoElement.style.color = '#e74c3c';
    }
}
```

### 3.2 ç™»å½•çŠ¶æ€æ£€æŸ¥
æ¸¸æˆæ“ä½œå‰ä¼šæ£€æŸ¥ç™»å½•çŠ¶æ€ï¼š
```javascript
async movePiece(index) {
    if (this.isGameWon) return;
    
    // æ£€æŸ¥æ˜¯å¦å·²ç™»å½•
    if (!this.isLoggedIn) {
        alert('è¯·å…ˆç™»å½•æ‰èƒ½å¼€å§‹æ¸¸æˆï¼');
        return;
    }
    
    // ... æ¸¸æˆé€»è¾‘
}
```

### 3.3 ç™»å‡ºåŠŸèƒ½
```javascript
logout() {
    this.isLoggedIn = false;
    this.currentUser = null;
    this.updateUserInfo();
}
```

## 4. UIäº¤äº’

### 4.1 ç™»å½•å¼¹çª—æ§åˆ¶
```javascript
// æ˜¾ç¤ºç™»å½•å¼¹çª—
showLoginModal() {
    document.getElementById('overlay').style.display = 'block';
    document.getElementById('loginModal').style.display = 'block';
    document.getElementById('loginError').style.display = 'none';
}

// å…³é—­ç™»å½•å¼¹çª—
closeLoginModal() {
    document.getElementById('overlay').style.display = 'none';
    document.getElementById('loginModal').style.display = 'none';
    document.getElementById('loginError').style.display = 'none';
    // æ¸…ç©ºè¾“å…¥æ¡†
    document.getElementById('employeeId').value = '';
    document.getElementById('employeeName').value = '';
}
```

### 4.2 é”™è¯¯æç¤º
- ä½¿ç”¨ `error-message` CSSç±»æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯
- åŠ¨æ€æ§åˆ¶æ˜¾ç¤º/éšè—çŠ¶æ€
- æä¾›å…·ä½“çš„é”™è¯¯æè¿°

## 5. å®‰å…¨è€ƒè™‘

### 5.1 å‰ç«¯éªŒè¯çš„å±€é™æ€§
- å‰ç«¯éªŒè¯ä»…ç”¨äºç”¨æˆ·ä½“éªŒä¼˜åŒ–
- çœŸå®çš„å®‰å…¨éªŒè¯åº”åœ¨åç«¯è¿›è¡Œ
- äººå‘˜æ•°æ®é€šè¿‡é™æ€JSONæ–‡ä»¶æä¾›ï¼Œé€‚åˆå†…éƒ¨ä½¿ç”¨

### 5.2 æ•°æ®ä¿æŠ¤
- äººå‘˜æ•°æ®å­˜å‚¨åœ¨æœ¬åœ°JSONæ–‡ä»¶ä¸­
- ä¸æ¶‰åŠæ•æ„Ÿä¿¡æ¯ä¼ è¾“
- ç™»å½•çŠ¶æ€ä»…åœ¨æµè§ˆå™¨ä¼šè¯ä¸­ç»´æŠ¤

## 6. æ‰©å±•æ€§

### 6.1 æ•°æ®æºæ‰©å±•
- æ”¯æŒä»ä¸åŒæ•°æ®æºåŠ è½½äººå‘˜ä¿¡æ¯
- å¯æ‰©å±•ä¸ºä»APIè·å–ç”¨æˆ·æ•°æ®
- æ”¯æŒåŠ¨æ€æ›´æ–°äººå‘˜åˆ—è¡¨

### 6.2 éªŒè¯é€»è¾‘æ‰©å±•
- å¯æ·»åŠ æ›´å¤šéªŒè¯è§„åˆ™ï¼ˆå¦‚å¯†ç ã€æƒé™ç­‰ï¼‰
- æ”¯æŒå¤šç§ç™»å½•æ–¹å¼
- å¯é›†æˆç¬¬ä¸‰æ–¹è®¤è¯æœåŠ¡

## 7. æ€»ç»“

è¯¥ç™»å½•ç³»ç»Ÿå®ç°äº†ä»¥ä¸‹æ ¸å¿ƒåŠŸèƒ½ï¼š
1. **æ•°æ®åŠ è½½**: ä»JSONæ–‡ä»¶åŠ è½½äººå‘˜æ•°æ®
2. **èº«ä»½éªŒè¯**: é€šè¿‡å·¥å·å§“åç²¾ç¡®åŒ¹é…éªŒè¯ç”¨æˆ·èº«ä»½
3. **çŠ¶æ€ç®¡ç†**: ç»´æŠ¤ç”¨æˆ·ç™»å½•çŠ¶æ€å’Œå½“å‰ç”¨æˆ·ä¿¡æ¯
4. **UIäº¤äº’**: æä¾›å‹å¥½çš„ç™»å½•ç•Œé¢å’Œé”™è¯¯æç¤º
5. **æ¸¸æˆé›†æˆ**: ä¸æ¸¸æˆé€»è¾‘ç´§å¯†é›†æˆï¼Œç¡®ä¿åªæœ‰ç™»å½•ç”¨æˆ·æ‰èƒ½æ¸¸æˆ

æ•´ä¸ªç™»å½•æµç¨‹ç®€æ´é«˜æ•ˆï¼Œé€‚åˆå†…éƒ¨ä½¿ç”¨çš„æ¸¸æˆåœºæ™¯ï¼ŒåŒæ—¶ä¿æŒäº†è‰¯å¥½çš„ç”¨æˆ·ä½“éªŒå’Œä»£ç å¯ç»´æŠ¤æ€§ã€‚
